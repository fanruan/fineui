/**
 * Created by User on 2017/3/22.
 */
var _strings = "    柳州市城贸金属材料有限责任公司      柳州市建福房屋租赁有限公司      柳州市迅昌数码办公设备有限责任公司      柳州市河海贸易有限责任公司      柳州市花篮制衣厂      柳州市兴溪物资有限公司      柳州市针织总厂      柳州市衡管物资有限公司      柳州市琪成机电设备有限公司      柳州市松林工程机械修理厂      柳州市积玉贸易有限公司      柳州市福运来贸易有限责任公司      柳州市钢义物资有限公司      柳州市洋力化工有限公司      柳州市悦盛贸易有限公司      柳州市雁城钢管物资有限公司      柳州市恒瑞钢材经营部      柳州市科拓电子有限公司      柳州市九方电子有限公司      柳州市桂龙汽车配件厂      柳州市制鞋工厂      柳州市炜力科贸有限公司      柳州市希翼贸易有限公司      柳州市兆金物资有限公司      柳州市和润电子科技有限责任公司      柳州市汇凯贸易有限公司      柳州市好机汇商贸有限公司      柳州市泛源商贸经营部      柳州市利汇达物资有限公司      广西全民药业有限责任公司      柳州超凡物资贸易有限责任公司      柳州市贵宏物资有限责任公司      柳州昊恒贸易有限责任公司      柳州市浦联物资有限公司      柳州市广通园林绿化工程有限责任公司      柳州市松发物资贸易有限责任公司      柳州市奥士达办公设备有限责任公司      柳州市海泰物资有限公司      柳州市金三环针织厂      柳州市钢贸物资有限公司      柳州市明阳纺织有限公司      柳州市世科科技发展有限公司      柳州市禄羊贸易有限公司      柳州市金兆阳商贸有限公司      柳州市汇昌物资经营部      柳州市林泰金属物资供应站      柳州市自来水管道材料设备公司      柳州市丹柳铝板有限公司      柳州市桂冶物资有限公司      柳州市宸业物资经营部      柳州市耀成贸易有限公司      柳州奥易自动化科技有限公司      柳州市萃丰科技有限责任公司      柳州市华储贸易有限责任公司      柳州市黄颜钢材有限责任公司      柳州市银盛物资有限责任公司      柳州市新仪化玻供应站      柳州市晶凯化工有限公司      广西柳州市柳江包装纸厂      柳州市志新物资有限责任公司      柳州市兆钢物资有限公司      柳州市友方科技发展有限责任公司      柳州市缝纫机台板家具总厂      柳州市晖海数码办公设备有限责任公司      柳州市富兰特服饰有限责任公司      柳州市柳北区富兴物资经营部      柳州市柳锌福利厂      柳州市海泉印刷有限责任公司      柳州市乾亨贸易有限公司      柳州市悦宁物资贸易有限公司      柳州市昊天贸易有限公司      广西惠字钢铁有限公司      柳州市名青物资有限公司      柳州市林郝物资有限公司      柳州市民政服装厂      柳州市多维劳保用品厂      柳州市轻工物资供应公司      柳州市程源物资有限责任公司      柳州市寿丰物资贸易有限责任公司      柳州市凯凡物资有限公司      柳州市利晖物资经营部      柳州市恒茂金属物资供应站      柳州市中储物资经营部      柳州市第二医疗器械厂      柳州市来鑫物资经营部      柳州市钢鑫物资贸易有限责任公司      柳州市双合袜业有限责任公司      柳州市茂松经贸有限责任公司      柳州市行行物资贸易有限公司      柳州市方一物资有限公司      柳州成异钢管销售有限公司      柳州广惠佳电脑有限公司      桂林市圣泽鑫物资有限公司柳州分公司      柳州市砼基建材贸易有限公司      柳州市海燕针织厂      上海浦光仪表厂柳州销售处      柳州市能电工贸有限责任公司      柳州市广贸物资有限公司      柳州市柳北区大昌电工灯饰经营部      柳州市金龙印务有限公司      柳州市奇缘婚典服务有限公司      柳州市盛博物资经营部      柳州市项元钢铁贸易有限公司      柳州市虞美人化妆品经营部      柳州市俊彦鞋厂      柳州市聚源特钢有限公司      柳州市迅龙科贸有限责任公司      柳州市恒飞电子有限责任公司      柳州市蓝正现代办公设备有限责任公司      柳州地区农业生产资料公司      柳州华菱钢管销售有限公司      柳州融通物资有限公司      柳州市可仁广告策划有限责任公司      柳州市鸟鑫物资有限责任公司      柳州市五丰钢材供应站      柳州市金江不锈钢有限公司      柳州市美日物资设备有限责任公司      柳州市鑫东物资贸易有限责任公司      柳州地区日用杂品公司      柳州市华纳物资贸易有限公司      柳州乾利金虹物资贸易有限责任公司      柳州市新迈计算机有限公司      柳州市富丽实业发展公司      柳州市石钢金属材料有限公司      柳州市力志传真机销售有限公司      广西宝森投资有限公司      柳州市嵘基商贸有限公司      柳州市景民商贸有限责任公司      柳州市银桥化玻有限责任公司      柳州市宏文糖烟店      柳州市科苑电脑网络有限公司      柳州市两面针旅游用品厂      柳州市立早室内装璜有限责任公司      柳州地化建材有限公司      柳州市涛达贸易有限公司      柳州市兰丰档案服务中心      柳州市惠贸物资有限责任公司      柳州市立文物资有限责任公司      柳州市致和商贸经营部      柳州市金色阳光信息咨询有限公司      柳州市赛利钢材经销部      柳州市日用化工厂      柳州市昆廷物资有限责任公司      柳州市邦盛贸易有限公司      柳州市济华贸易有限公司      柳州昕威橡塑化工经营部      柳州市联业贸易有限公司      柳州市兰钢贸易有限公司      柳州市子欣科技有限公司      柳州市狄龙机电设备有限公司      柳州市方真物资贸易有限公司      柳州市银鸥废旧回收中心      柳州市冠宝贸易有限公司      柳州市鑫盛德商务咨询有限责任公司      柳州市泰汇银通经贸有限公司      广西瀚维智测科技有限公司      柳州市钓鱼郎制衣有限责任公司      柳州溪水物资有限公司      柳州市融峰物资有限责任公司      广西新地科技有限责任公司      柳州市纺织装饰公司      柳州市粤翔冶金炉料有限公司      柳州市远腾贸易有限公司      柳州市东鸿城市改造有限公司      广西丛欣实业有限公司      柳州市服装厂      柳州市立安联合刀片有限公司      广西国扬投资有限责任公司      柳州市铭泰办公设备公司      柳州市桂钢物资供应站      柳州市昱升物资有限责任公司      柳州市鹰飞灿科贸有限公司      柳州市先导科贸有限公司      柳州市金秋建材物资经营部      柳州市童装厂      柳州市民泽物资有限公司      柳州市恒先物资贸易有限公司      柳州市银夏冷气工程有限责任公司      柳州粮食批发有限责任公司      柳州市金银华窗纱制造有限责任公司      柳州市三方贸易有限公司      柳州市丰涛商贸有限责任公司      柳州华智企业管理咨询有限责任公司      柳州市诚正建筑工程施工图审查有限公司      柳州市今科电讯设备营销中心      柳州市闽德电子有限公司      柳州市鑫虹针织厂      柳州市畅通通讯器材有限责任公司      柳州市正钢物资经营部      柳州市新柳饲料有限责任公司      柳州市黄村油库      柳州市天泰电力装饰工程有限公司      柳州市兆吉物资有限责任公司      柳州市八龙纸制品有限责任公司      柳州市巨佳电脑网络科技有限公司      ";
//各种通用数据
var ITEMS = BI.map(_strings.match(/[^\s]+/g), function (i, v) {
    return {
        text: v,
        value: v,
        title: v
    }
});
Demo.MultiSelectCombo = BI.inherit(BI.Widget, {
    props: {
        baseCls: "demo-multi-select-combo"
    },

    _createMultiSelectCombo: function () {
        var self = this;
        var widget = BI.createWidget({
            type: 'bi.multi_select_combo',
            itemsCreator: BI.bind(this._itemsCreator, this),
            width: 200
        });

        widget.on(BI.MultiSelectCombo.EVENT_CONFIRM, function () {
            BI.Msg.toast(JSON.stringify(this.getValue()));
        });

        return widget;
    },

    _getItemsByTimes: function (items, times) {
        var res = [];
        for (var i = (times - 1) * 3; items[i] && i < times * 3; i++) {
            res.push(items[i]);
        }
        return res;
    },

    _hasNextByTimes: function (items, times) {
        return times * 3 < items.length;
    },

    _itemsCreator: function (options, callback) {
        var self = this;
        var items = ITEMS;
        if (options.keyword) {
            var search = BI.Func.getSearchResult(items, options.keyword);
            items = search.matched.concat(search.finded);
        }
        if (options.selected_values) {//过滤
            var filter = BI.makeObject(options.selected_values, true);
            items = BI.filter(items, function (i, ob) {
                return !filter[ob.value];
            });
        }
        if (options.type == BI.MultiSelectCombo.REQ_GET_ALL_DATA) {
            callback({
                items: items
            });
            return;
        }
        if (options.type == BI.MultiSelectCombo.REQ_GET_DATA_LENGTH) {
            callback({count: items.length});
            return;
        }
        BI.delay(function () {
            callback({
                items: self._getItemsByTimes(items, options.times),
                hasNext: self._hasNextByTimes(items, options.times)
            });
        }, 1000);
    },

    render: function () {
        return {
            type: 'bi.absolute',
            scrolly: false,
            items: [{
                el: this._createMultiSelectCombo(),
                right: 10,
                top: 10
            }]
        }
    }
});
$.shortcut("demo.multi_select_combo", Demo.MultiSelectCombo);